<% if current_user.present? %>
<body id="settings">
    <div class="container">
</div>
    <%= form_for current_user, :html => { :multipart => true , :class => 'hidden' },:url => url_for(:controller => 'pages', :action => 'checkUsername', :user_id => current_user.id ), :method => "get" , remote: true  do |f| %>
        <%= f.text_field :name, :value => @user.username, :id => 'username-check-field' %>
        <%= f.submit "Save", id: 'username-check-submit'%>
    <% end %>
    <%= form_for current_user, :html => { :multipart => true , :class => 'hidden' },:url => url_for(:controller => 'pages', :action => 'checkEmail', :user_id => current_user.id ), :method => "get" , remote: true  do |f| %>
        <%= f.text_field :email, :value => @user.email, :id => 'email-check-field' %>
        <%= f.submit "Save", id: 'email-check-submit'%>
    <% end %>
<div id="settings-wrapper">
    <h2 id="settings-title">Settings<% if current_user.pro == true %><span id="settings-pro">PRO</span><% end %></h2>
    <div id="settings-options">
        <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
                  <%= devise_error_messages! %>
        
        <div id="settings-night" class="settings-option-wrapper">
            <span>Dark Mode</span>
            <div class="checkbox-wrapper">
                <div class="checkbox">
                    <% if current_user.nightmode === true%>
                        <%= f.check_box :nightmode, checked: true %>
                    <% else %>    
                        <%= f.check_box :nightmode, checked: false %>
                    <% end %>
                    <label></label>
                </div>    
            </div>
        </div>
        
        <div id="settings-sound" class="settings-option-wrapper">
            <span>Notification Sound</span>
            <div class="checkbox-wrapper">
                <div class="checkbox">
                    <% if current_user.notificationsound === true%>
                        <%= f.check_box :notificationsound, checked: true %>
                    <% else %>    
                        <%= f.check_box :notificationsound, checked: false %>
                    <% end %>
                    <label></label>
                </div>    
            </div>
        </div>
        
        <div id="settings-account" class="settings-option-wrapper">
            <span>Manage Account</span>
            <div id="settings-option-more">
                
                
                  <div class="field">
                    <%= f.label :username %>
                    <%= f.text_field :username, :value => @user.username, :id => 'username-field-settings' %>
                    <i class="material-icons" id="username-check-icon">check_circle</i>
                  </div>
                        
                        
                <div class="field">
                    <%= f.label :bio %>
                    <%= f.text_field :bio, :value => @user.bio %>
                  </div>
                                    
                  <div class="field">
                    <%= f.label :email %>
                    <%= f.email_field :email, :value => @user.email, :id => 'email-field-settings', :autocomplete => :off  %>
                    <i class="material-icons" id="email-check-icon">check_circle</i>
                  </div>
                  
                  <div id="more-settings-options-wrapper">
                      <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
                        <div>Currently waiting confirmation for: <%= resource.unconfirmed_email %></div>
                      <% end %>
                    
                      <div class="field">
                        <label>New Password</label>
                        <%= f.password_field :password, autocomplete: "off", id: "new-password-field" %>
                      </div>
                    
                      <div class="field">
                        <%= f.label :password_confirmation %>
                        <%= f.password_field :password_confirmation, autocomplete: "off" %>
                      </div>
                      <%= f.submit "Save", id: "save-settings", class: "hidden" %>
                      
                  </div>
                
                    <i id="more-settings-options-button" class="material-icons">expand_more</i>
                    <i id="less-settings-options-button" class="material-icons">expand_less</i>
                
                    
                
                
            </div>
        </div>
        
        <div id="settings-themes" class="settings-option-wrapper hidden">
            <span>Themes</span>
            <div class="settings-option-more">
                
            </div>
        </div>
        
        <% if current_user.pro == (false || nil) %>
        <div>Upgrade to <span id="settings-pro" >PRO</span></div>
        <% end %>
        <div id="settings-logout" class="settings-option-wrapper">
            <%= link_to('Log Out', destroy_user_session_path, :method => :delete) %>
            <span id="save-settings-before">Save</span>
        </div>
        <% end %>
    </div>
</div>
</body>
<% else %>
<script type="text/javascript">
    window.location.href="/users/sign_in"  // put your correct path in a string here
  </script>
<%= form_for("user", :url => user_session_path) do |f| %>
  <%= f.text_field :email %>
  <%= f.password_field :password %>
  <%= f.check_box :remember_me %>
  <%= f.label :remember_me %>
  <%= f.submit 'Sign in' %>
  <%= link_to "Forgot your password?", new_password_path('user') %>
<% end %>
<% end %>